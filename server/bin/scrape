#!/usr/bin/env node

const mongoose = require("mongoose");
const Course = require("../models/course");

require("dotenv").config();

const { scrape: scrapeSchedule } = require("../scrapers/schedule");

async function main() {
  await mongoose.connect(process.env.DB_URL, {
    useNewUrlParser: true,
    useUnifiedTopology: true,
  });
  console.log("Connected to MongoDB database");

  await Course.deleteMany({});
  console.log("Cleared courses collection");

  console.log("[Schedule] start");
  await scrapeSchedule();
  console.log("[Schedule] done");
}

main().then("Scraping done");

// This is broken and never stops so...
